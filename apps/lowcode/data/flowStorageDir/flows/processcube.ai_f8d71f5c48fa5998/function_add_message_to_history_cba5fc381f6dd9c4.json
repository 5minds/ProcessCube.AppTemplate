{
  "id": "cba5fc381f6dd9c4",
  "type": "function",
  "z": "f8d71f5c48fa5998",
  "name": "add message to history",
  "func": "const key = `messages-${msg.userId}`;\nconst messages = global.get(key) ?? [];\n\nconst payload = msg.payload;\n\nmessages.push(payload.choices[0].message);\nglobal.set(key, messages);\n\nmsg.payload = payload;\n\nreturn msg;",
  "outputs": 1,
  "timeout": 0,
  "noerr": 0,
  "initialize": "",
  "finalize": "",
  "libs": [],
  "g": "40924ad744fda798",
  "wires": [
    [
      "fc999ae14f92f0e7"
    ]
  ]
}